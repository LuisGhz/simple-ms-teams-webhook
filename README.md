# Simple MS Teams Webhook
---

A GitHub Action to send notifications to MS Teams using the syntax of [Legacy Actionable Messages](https://docs.microsoft.com/en-us/outlook/actionable-messages/message-card-reference) (Not all features yet).

---

## Inputs

* **webhook_url**: Url generated by Incoming Webhook for MS Teams channel
  * **required**: yes
* **summary**: Card summary
  * **required**: no
  * **default**: ''
* **title**: Card title
  * **required**: no
  * **default**: ''
* **text**: Card body text
  * **required**: no
  * **default**: ''
* **theme-color**: Brand color card. In hexadecimal (without **#**)
  * **required**: no
  * **default**: 28a745
* **sections**: For more information visit [Sections fields](https://docs.microsoft.com/en-us/outlook/actionable-messages/message-card-reference#section-fields). This action uses yaml format in value as string. Some examples below.
  * **required**: no
  * **default**: ''
* **potential-action**: For more information visit [Actions](https://docs.microsoft.com/en-us/outlook/actionable-messages/message-card-reference#actions). This action uses yaml format in value as string. Some examples below.
  * **required**: no
  * **default**: ''
* **yaml-ident**: This action uses [YAML](https://www.npmjs.com/package/yaml) to parse the value of **sections** & **potential-action** to json properties. This input configures the number of spaces used for the indentations.
  * **required**: no
  * **default**: 2

---

## Examples

### Send only basic fields

```yaml
- name: run action
      id: run_action
      uses: luisghz/simple-ms-teams-webhook-notifier@v1
      with: 
        webhook_url: ${{ secrets.WEBHOOK_URL }}
        summary: 'Card Summary'
        title: 'Card title'
        text: 'Card text'
```

### Use sections (You can use the basic fields at the same time)

```yaml
- name: run action
      id: run_action
      uses: luisghz/simple-ms-teams-webhook-notifier@v1
      with: 
        webhook_url: ${{ secrets.WEBHOOK_URL }}
        summary: 'Card Summary'
        title: 'Card Title'
        text: 'Card Text'
        sections: |
          - activityTitle: "Section title"
            activitySubtitle: "Section subtitle"
            activityImage: "https://image-url.com"
            facts:
              - name: 'Fact 1'
                value: 'Value 1'
              - name: 'Fact 2'
                value: 'Value 2'
```

### Use potential action

```yaml
- name: run action
      id: run_action
      uses: luisghz/simple-ms-teams-webhook-notifier@v1
      with: 
        webhook_url: ${{ secrets.WEBHOOK_URL }}
        summary: 'Card Summary'
        title: 'Card Title'
        text: 'Card Text'
        potential-action: |
        	- "@type": "OpenUri"
	          name: "Open Executed Action"
	          targets:
	          	- os: "default"
	          	  uri: "https://docs.microsoft.com/outlook/actionable-messages"
	          
```

**Note**: To use special characters you must use double quotes **" "** in the property name. You can use double quotes in the values too.